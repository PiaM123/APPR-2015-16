---
title: "Analiza izobrazbe v Sloveniji in Nemčiji"
author: "Pia Modrijan"
output:
  pdf_document:
    latex_engine: xelatex
    includes:
      in_header: lib/styles.sty
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8", echo = FALSE)
```

# Izbira teme

Analizirala bom stopnjo izobrazbe moških in žensk v Sloveniji ter v Nemčiji v letu 2013. Osredotočila se bom na osnovnošolsko, srednješolsko in visokošolsko izobrazbo.
V nadaljevanju bom primirjala delež oseb z osnovnošolsko, srednješolsko in visokošolsko izobrazbo pri nas in v Nemčiji, primerjave pa bom naredila tudi po spolu.
Zanimale me bodo osebe stare 20 do 24 let, 25 do 29 let, 30 do 34 let in 35 do 39 let.
Za Slovenijo bom analizirala tudi povprečno mesečno plačo glede na stopnjo izobrazbe ter število delovno aktivnih glede na stopnjo izobrazbe. Za Nemčijo teh podatkov žal nisem dobila.

Podatke sem pridobila na spletu:

* <http://pxweb.stat.si/pxweb/Dialog/varval.asp?ma=05G2010S&ti=&path=../Database/Dem_soc/05_prebivalstvo/20_soc_ekon_preb/01_05G20_izobrazba/&lang=2>

* <http://stats.oecd.org/Index.aspx?datasetcode=EDU_ENRL_AGE#>

* <http://pxweb.stat.si/pxweb/Dialog/varval.asp?ma=0764701S&ti=&path=../Database/Dem_soc/07_trg_dela/06_akt_preb_reg_viri_strukturni/03_07647_del_aktivni_izobrazba/&lang=2>

* <http://pxweb.stat.si/pxweb/Dialog/varval.asp?ma=0711340S&ti=&path=../Database/Dem_soc/07_trg_dela/10_place/03_07113_strukt_statistika/&lang=2>

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Uvozila sem podatke o izobrazbi žensk in moških v Sloveniji v obliki HTML in CSV iz spletne strani statističnega urada Slovenije, ter podatke o izobrazbi žensk in moških v Nemčiji v obliki CSV iz spletne strani OECD.

Spodnja tabela prikazuje stipnjo izobrazbe žensk in moških v Sloveniji. Tabelo sem spremenila v obliko tidy data.

```{r IzobrazbaMZS}
kable(head(IzobrazbaSlovenija))
```

Ta tabela prikazuje podatke za izobrazbo moških v Nemčiji. Podatki so v obliki tidy data in so ločeni po spolu, stopnji izobrazbe in starosti.

```{r IzobrazbaMN}
kable(head(MoskiNemcija))
```

Ta tabela prikazuje podatke za izobrazbo žensk v Nemčiji. So v enaki obliki kot zgornji podatki za moške.

```{r IzobrazbaZN}
kable(head(ZenskeNemcija))
```

Zadnja tabela pa vsebuje podatke o številu aktivnih oseb v Sloveniji po stopnji izobrazbe, ter povprečne mesečne bruto plače glede na stopnjo izobrazbe. Tudi ti podatki so ločeni po spolu.

```{r PlaceAktivnost}
kable(head(PlaceAktivnostSlovenija))
```

V vseh tabelah so podatki točne številke oseb z določeno stopnjo izobrazbe

------

# Grafi

```{r grafIzobrazbaSLO, echo=FALSE}
grafIzobrazbaSLO <- ggplot(IzobrazbaSlovenija, aes(x=Stopnja.izobrazbe, y=Stevilo.oseb)) +
  geom_bar(stat = "identity") + theme_minimal() + aes(fill=Stopnja.izobrazbe) +
  labs(title = "Število oseb z določeno stopnjo izobrazbe v Sloveniji")
print(grafIzobrazbaSLO)
```

Prvi graf prikazuje koliko je oseb s katero stopnjo izobrazbe v Sloveniji. Tu so moški in ženske združeni. Vidimo, da prevladujejo osebe, ki imajo srednješolsko izobrazbo.

```{r grafPlaceAktivnost, echo=FALSE}
grafPlaceAktivnost <- ggplot(PlaceAktivnostSlovenija, aes(x=Stopnja.Izobrazbe, y=Število.Delovno.Aktivnih.Oseb)) +
  geom_bar(stat = "identity") + theme_minimal() + aes(fill=Stopnja.Izobrazbe) +
  labs(title = "Število delovno aktivnih oseb glede na stopnjo izobrazabe")
print(grafPlaceAktivnost)
```

Ta graf prikazuje število delovno aktivnih oseb glede na stopnjo izobrazbe. Vidimo, da je največ delovno aktivnih oseb dokončalo srednješolsko izobrazbo in najmanj osnovnošolsko izobrazbo.

```{r grafIzobrazbaSpol, echo=FALSE}
ggplot(IzobrazbaSlovenija %>% filter(Leto == 2013) %>%
         group_by(Spol, Stopnja.izobrazbe) %>% summarise(Skupaj = sum(Stevilo.oseb)/1000),
       aes(x = Stopnja.izobrazbe, y = Skupaj, fill = Spol)) +
  geom_bar(stat = "identity", position = "dodge")
print(grafIzobrazbaSpol)
```